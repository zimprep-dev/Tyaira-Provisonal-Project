{% extends "base.html" %}

{% block title %}Premium Subscription - Driver Testing Platform{% endblock %}

{% block content %}
<div class="dashboard">
    <div class="dashboard-header">
        <h1><i data-feather="star" class="dashboard-icon"></i> Premium Subscription</h1>
        <div class="user-status">
            {% if has_subscription %}
                <span class="status-badge subscribed"><i data-feather="check-circle" class="badge-icon"></i> Active Subscription</span>
            {% else %}
                <span class="status-badge free"><i data-feather="lock" class="badge-icon"></i> Free Tier</span>
            {% endif %}
        </div>
    </div>

    <!-- Current Subscription Status -->
    {% if has_subscription and latest_transaction %}
    <div class="dashboard-stats">
        <div class="stat-card">
            <h3><i data-feather="award" class="stat-icon"></i> Status</h3>
            <div class="stat-number">Active</div>
        </div>
        <div class="stat-card">
            <h3><i data-feather="calendar" class="stat-icon"></i> Expires</h3>
            <div class="stat-number">{{ current_user.subscription_end_date.strftime('%b %d, %Y') if current_user.subscription_end_date else 'N/A' }}</div>
        </div>
        <div class="stat-card">
            <h3><i data-feather="dollar-sign" class="stat-icon"></i> Monthly</h3>
            <div class="stat-number">$5.00</div>
        </div>
    </div>
    {% endif %}

    <!-- Premium Plan Card -->
    {% if not has_subscription %}
    <div class="dashboard-actions">
        <div class="action-card featured">
            <h3><i data-feather="zap" class="action-icon"></i> Premium Monthly Subscription</h3>
            <div class="subscription-price">
                <span class="price-amount">$5.00</span>
                <span class="price-period">/month</span>
            </div>
            
            <div class="subscription-features">
                <ul>
                    <li><i data-feather="check"></i> Unlimited practice tests</li>
                    <li><i data-feather="check"></i> 400+ questions database</li>
                    <li><i data-feather="check"></i> Detailed explanations</li>
                    <li><i data-feather="check"></i> Progress tracking & analytics</li>
                    <li><i data-feather="check"></i> Mobile friendly interface</li>
                    <li><i data-feather="check"></i> No advertisements</li>
                </ul>
            </div>

            {% if plans and plans|length > 0 %}
            <form method="POST" action="{{ url_for('initiate_payment', plan_id=plans[0].id) }}">
                <button type="submit" class="btn btn-primary btn-large">
                    <i data-feather="credit-card"></i> Subscribe Now
                </button>
            </form>
            {% endif %}

            <div class="payment-security">
                <small><i data-feather="lock"></i> Secure payment via Paynow â€¢ Instant activation</small>
            </div>
        </div>
    </div>
    {% else %}
    <div class="dashboard-actions">
        <div class="action-card">
            <h3><i data-feather="info" class="action-icon"></i> Subscription Information</h3>
            <p>Your premium subscription is currently active. You have unlimited access to all features.</p>
            {% if current_user.subscription_end_date %}
            <p><strong>Your subscription will renew or expire on {{ current_user.subscription_end_date.strftime('%B %d, %Y') }}</strong></p>
            {% endif %}
        </div>
    </div>
    {% endif %}

    <!-- Benefits Section -->
    <div class="recent-tests">
        <h2><i data-feather="gift" class="section-icon"></i> What You Get with Premium</h2>
        <div class="test-results">
            <div class="test-result">
                <div class="test-date"><i data-feather="check-circle" style="color: #28a745;"></i> Unlimited Tests</div>
                <div class="test-score">Take as many practice tests as you need</div>
            </div>
            <div class="test-result">
                <div class="test-date"><i data-feather="database" style="color: #007bff;"></i> Full Question Bank</div>
                <div class="test-score">Access all 400+ driving theory questions</div>
            </div>
            <div class="test-result">
                <div class="test-date"><i data-feather="bar-chart-2" style="color: #ffc107;"></i> Performance Analytics</div>
                <div class="test-score">Track your progress and identify weak areas</div>
            </div>
            <div class="test-result">
                <div class="test-date"><i data-feather="smartphone" style="color: #17a2b8;"></i> Mobile Optimized</div>
                <div class="test-score">Study anywhere on any device</div>
            </div>
        </div>
    </div>
</div>

<style>
.subscription-price {
    text-align: center;
    margin: 20px 0;
}

.price-amount {
    font-size: 3rem;
    font-weight: bold;
    color: #007bff;
}

.price-period {
    font-size: 1.2rem;
    color: #666;
}

.subscription-features {
    margin: 30px 0;
}

.subscription-features ul {
    list-style: none;
    padding: 0;
}

.subscription-features li {
    padding: 10px 0;
    display: flex;
    align-items: center;
    gap: 10px;
}

.subscription-features li i {
    color: #28a745;
    width: 20px;
    height: 20px;
}

.btn-large {
    padding: 15px 30px;
    font-size: 1.1rem;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.payment-security {
    text-align: center;
    margin-top: 15px;
    color: #666;
}

.payment-security i {
    width: 16px;
    height: 16px;
    vertical-align: middle;
}
</style>
{% endblock %}
